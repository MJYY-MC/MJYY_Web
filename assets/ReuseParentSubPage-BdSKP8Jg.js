import{H as B,d as _,f as P,a as u,h as I,j as b,k as s,t as f,u as d,I as T,G as w,q as j,F,n as E,A as q,J as A,p as K,K as N}from"./virtual_svg-icons-register-BeNbac6v.js";import{u as V}from"./index-Dm3GjZss.js";import"./app-DmW_s971.js";const L="https://web.mjyy.top/server",R="5v2co487ycn7t8qorhntov584r7ghcqo45nv7ghqru4io75vyn";function z(i){return B?null:{code:3}}async function J(i,a=void 0){{const t=z();if(t!=null)return t}try{const t=await fetch(`${L}${i}`,{method:"POST",headers:{"X-API-Key":R,"Content-Type":"application/json"},body:JSON.stringify(a||{})});return{code:0,result:{ok:t.ok,json:await t.json(),statusCode:t.status}}}catch{return{code:4}}}const O={class:"card-header d-flex justify-content-center"},D={class:"card-body"},G={class:"input-group"},H={class:"input-group-text"},X=["placeholder"],x=_({__name:"passwordInput",emits:["passwdEnter"],setup(i,{expose:a,emit:t}){const{lt:n}=P(),o=t,e=u(null),l=u(null),p=u(!1),c=u(null),r=u(null),h=u("alert-secondary");function y(v,k){r.value&&(r.value.innerText=n(`feedback.${k}`),h.value=v,p.value=v=="alert-danger",r.value.style.display="")}function m(){l.value&&(l.value.value!=""?o("passwdEnter",l.value.value):y("alert-danger",0))}function C(){return l.value&&c.value?(l.value.disabled=!0,c.value.disabled=!0,!0):!1}function S(){return l.value&&c.value?(l.value.disabled=!1,c.value.disabled=!1,!0):!1}function $(){return e.value?(e.value.style.display="none",!0):!1}function U(){return e.value?(e.value.style.display="",!0):!1}return a({showFeedback:y,lockInput:C,unlockInput:S,hidePanel:$,unhidePanel:U}),(v,k)=>(b(),I("div",{ref_key:"pswIptPanel",ref:e,class:"card"},[s("div",O,[s("strong",null,f(d(n)("title")),1)]),s("div",D,[s("div",G,[s("span",H,f(d(n)("label")),1),s("input",{ref_key:"passwordInput",ref:l,type:"password",class:w(["form-control",{"is-invalid":p.value}]),placeholder:d(n)("inputText"),onKeyup:T(m,["enter"])},null,42,X),s("button",{class:"btn btn-outline-secondary",type:"button",ref_key:"enterButton",ref:c,onClick:m},f(d(n)("enterBtn")),513)]),s("div",{ref_key:"feedback",ref:r,class:w(["alert mt-3 mb-0",[h.value]]),role:"alert",style:{display:"none"}},null,2)])],512))}});function g(i){const a=i;a.__i18n=a.__i18n||[],a.__i18n.push({locale:"",resource:{"zh-CN":{label:{t:0,b:{t:2,i:[{t:3}],s:"访问密码"}},enterBtn:{t:0,b:{t:2,i:[{t:3}],s:"进入"}},inputText:{t:0,b:{t:2,i:[{t:3}],s:"密码"}},feedback:{0:{t:0,b:{t:2,i:[{t:3}],s:"密码不可为空"}},1:{t:0,b:{t:2,i:[{t:3}],s:"密码错误"}},2:{t:0,b:{t:2,i:[{t:3}],s:"无法连接至服务"}},3:{t:0,b:{t:2,i:[{t:3}],s:"验证成功，等待加载"}},4:{t:0,b:{t:2,i:[{t:3}],s:"正在验证"}}},title:{t:0,b:{t:2,i:[{t:3}],s:"访问限制内容"}}},"en-US":{label:{t:0,b:{t:2,i:[{t:3}],s:"Access Password"}},enterBtn:{t:0,b:{t:2,i:[{t:3}],s:"Enter"}},inputText:{t:0,b:{t:2,i:[{t:3}],s:"Password"}},feedback:{0:{t:0,b:{t:2,i:[{t:3}],s:"Password cannot be empty"}},1:{t:0,b:{t:2,i:[{t:3}],s:"Incorrect password"}},2:{t:0,b:{t:2,i:[{t:3}],s:"Unable to connect to the service"}},3:{t:0,b:{t:2,i:[{t:3}],s:"Verification successful, waiting to load"}},4:{t:0,b:{t:2,i:[{t:3}],s:"Verifying"}}},title:{t:0,b:{t:2,i:[{t:3}],s:"Restricted Content"}}}}})}typeof g=="function"&&g(x);const M={id:"main"},Q={id:"authBox"},W={id:"mainTitle"},Y=_({__name:"AuthSubPage",props:{targetUrlPath:{type:String,required:!0},title:{type:String,default:""}},setup(i){const a=i,t=u(null);let n=!1;const o=u(null),e=u(null);async function l(c){if(e.value){e.value.showFeedback("alert-secondary",4),e.value.lockInput();const r=await J(a.targetUrlPath,{Password:c});r.result!=null?r.result.ok?(e.value.showFeedback("alert-success",3),n=!0,t.value.src=`${r.result.json.url}?passkey=${r.result.json.paras.passkey}`):r.result.statusCode==401?(e.value.showFeedback("alert-danger",1),e.value.unlockInput()):(e.value.showFeedback("alert-warning",2),e.value.unlockInput()):(e.value.showFeedback("alert-warning",2),e.value.unlockInput())}}function p(){t.value&&o.value&&n&&(t.value.style.display="",o.value.style.display="none")}return(c,r)=>(b(),I(F,null,[s("div",M,[s("iframe",{ref_key:"mainIframe",ref:t,id:"mainIframe",src:"",onload:p,style:{display:"none"},sandbox:"allow-scripts allow-same-origin allow-forms"},null,512)]),s("div",{id:"authContainer",ref_key:"authContainer",ref:o},[s("div",Q,[s("h2",W,f(a.title),1),j(x,{ref_key:"passwordInput",ref:e,onPasswdEnter:l},null,512)])],512)],64))}}),Z=E(Y,[["__scopeId","data-v-2de80933"]]),se=_({__name:"ReuseParentSubPage",setup(i){const a=q(),t=A(()=>({authSubPage:{targetUrlPath:a.meta.authSubPage_targetUrlPath},localePrefix:a.meta.localePrefix})),{gt:n}=P(),o=t.value.localePrefix;return K(o,()=>{V(n(`${o}.title`))}),(e,l)=>(b(),N(Z,{targetUrlPath:t.value.authSubPage.targetUrlPath,title:d(n)(`${d(o)}.subTitle`)},null,8,["targetUrlPath","title"]))}});export{se as default};
