import{H as B,d as b,f as P,a as i,h as I,j as _,k as r,t as v,u as f,I as j,G as w,q as T,n as E,A as F,J as q,p as A,K}from"./virtual_svg-icons-register-Cl4E2ipK.js";import{u as N}from"./index-xgp8R6pT.js";import"./app-CPi8I4Yn.js";const V="https://web.mjyy.top/server",L="5v2co487ycn7t8qorhntov584r7ghcqo45nv7ghqru4io75vyn";function R(o){return B?null:{code:3}}async function z(o,a=void 0){{const e=R();if(e!=null)return e}try{const e=await fetch(`${V}${o}`,{method:"POST",headers:{"X-API-Key":L,"Content-Type":"application/json"},body:JSON.stringify(a||{})});return{code:0,result:{ok:e.ok,json:await e.json(),statusCode:e.status}}}catch{return{code:4}}}const J={class:"card-header d-flex justify-content-center"},O={class:"card-body"},D={class:"input-group"},G={class:"input-group-text"},H=["placeholder"],x=b({__name:"passwordInput",emits:["passwdEnter"],setup(o,{expose:a,emit:e}){const{lt:l}=P(),t=e,u=i(null),n=i(null),c=i(!1),s=i(null),d=i(null),h=i("alert-secondary");function y(p,k){d.value&&(d.value.innerText=l(`feedback.${k}`),h.value=p,c.value=p=="alert-danger",d.value.style.display="")}function m(){n.value&&(n.value.value!=""?t("passwdEnter",n.value.value):y("alert-danger",0))}function S(){return n.value&&s.value?(n.value.disabled=!0,s.value.disabled=!0,!0):!1}function C(){return n.value&&s.value?(n.value.disabled=!1,s.value.disabled=!1,!0):!1}function U(){return u.value?(u.value.style.display="none",!0):!1}function $(){return u.value?(u.value.style.display="",!0):!1}return a({showFeedback:y,lockInput:S,unlockInput:C,hidePanel:U,unhidePanel:$}),(p,k)=>(_(),I("div",{ref_key:"pswIptPanel",ref:u,class:"card"},[r("div",J,[r("strong",null,v(f(l)("title")),1)]),r("div",O,[r("div",D,[r("span",G,v(f(l)("label")),1),r("input",{ref_key:"passwordInput",ref:n,type:"password",class:w(["form-control",{"is-invalid":c.value}]),placeholder:f(l)("inputText"),onKeyup:j(m,["enter"])},null,42,H),r("button",{class:"btn btn-outline-secondary",type:"button",ref_key:"enterButton",ref:s,onClick:m},v(f(l)("enterBtn")),513)]),r("div",{ref_key:"feedback",ref:d,class:w(["alert mt-3 mb-0",[h.value]]),role:"alert",style:{display:"none"}},null,2)])],512))}});function g(o){const a=o;a.__i18n=a.__i18n||[],a.__i18n.push({locale:"",resource:{"zh-CN":{label:{t:0,b:{t:2,i:[{t:3}],s:"访问密码"}},enterBtn:{t:0,b:{t:2,i:[{t:3}],s:"进入"}},inputText:{t:0,b:{t:2,i:[{t:3}],s:"密码"}},feedback:{0:{t:0,b:{t:2,i:[{t:3}],s:"密码不可为空"}},1:{t:0,b:{t:2,i:[{t:3}],s:"密码错误"}},2:{t:0,b:{t:2,i:[{t:3}],s:"无法连接至服务"}},3:{t:0,b:{t:2,i:[{t:3}],s:"验证成功，等待加载"}},4:{t:0,b:{t:2,i:[{t:3}],s:"正在验证"}}},title:{t:0,b:{t:2,i:[{t:3}],s:"访问限制内容"}}},"en-US":{label:{t:0,b:{t:2,i:[{t:3}],s:"Access Password"}},enterBtn:{t:0,b:{t:2,i:[{t:3}],s:"Enter"}},inputText:{t:0,b:{t:2,i:[{t:3}],s:"Password"}},feedback:{0:{t:0,b:{t:2,i:[{t:3}],s:"Password cannot be empty"}},1:{t:0,b:{t:2,i:[{t:3}],s:"Incorrect password"}},2:{t:0,b:{t:2,i:[{t:3}],s:"Unable to connect to the service"}},3:{t:0,b:{t:2,i:[{t:3}],s:"Verification successful, waiting to load"}},4:{t:0,b:{t:2,i:[{t:3}],s:"Verifying"}}},title:{t:0,b:{t:2,i:[{t:3}],s:"Restricted Content"}}}}})}typeof g=="function"&&g(x);const X={id:"main"},M={id:"fullContainer"},Q=b({__name:"AuthSubPage",props:{targetUrlPath:{type:String,required:!0}},setup(o){const a=o,e=i(null);let l=!1;const t=i(null);async function u(c){if(t.value){t.value.showFeedback("alert-secondary",4),t.value.lockInput();const s=await z(a.targetUrlPath,{Password:c});s.result!=null?s.result.ok?(t.value.showFeedback("alert-success",3),l=!0,e.value.src=`${s.result.json.url}?passkey=${s.result.json.paras.passkey}`):s.result.statusCode==401?(t.value.showFeedback("alert-danger",1),t.value.unlockInput()):(t.value.showFeedback("alert-warning",2),t.value.unlockInput()):(t.value.showFeedback("alert-warning",2),t.value.unlockInput())}}function n(){e.value&&l&&(e.value.style.display="",t.value?.hidePanel())}return(c,s)=>(_(),I("div",X,[r("iframe",{ref_key:"mainIframe",ref:e,id:"mainIframe",src:"",onload:n,style:{display:"none"},sandbox:"allow-scripts allow-same-origin allow-forms"},null,512),r("div",M,[T(x,{ref_key:"passwordInput",ref:t,onPasswdEnter:u},null,512)])]))}}),W=E(Q,[["__scopeId","data-v-e252fdcb"]]),te=b({__name:"ReuseParentSubPage",setup(o){const a=F(),e=q(()=>({authSubPage:{targetUrlPath:a.meta.authSubPage_targetUrlPath},localePrefix:a.meta.localePrefix})),{gt:l}=P(),t=e.value.localePrefix;return A(t,()=>{N(l(`${t}.title`))}),(u,n)=>(_(),K(W,{targetUrlPath:e.value.authSubPage.targetUrlPath},null,8,["targetUrlPath"]))}});export{te as default};
